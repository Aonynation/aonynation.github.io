<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>基础组合数练习题</title>
    <link href="/2022/11/06/ji_chu_zu_he_lian_xi_ti/"/>
    <url>/2022/11/06/ji_chu_zu_he_lian_xi_ti/</url>
    
    <content type="html"><![CDATA[<p>题目很简单，求：<br>$$<br>Ans&#x3D;\frac{\sum\limits_{i&#x3D;m}^n\binom{i-1}{m-1}\times i^k}{\binom{n}{m}}<br>$$<br>其中，给定 $n$ ，$m$ 和 $k$ 。<br>满足 $m\leq n \leq 10^7 , k\leq 5000$ ，数据组数不超过 $5000$ 。</p><p>前置知识：</p><ul><li>$i^k&#x3D;\sum\limits_{j&#x3D;0}^k\begin{Bmatrix}k\j\end{Bmatrix}(-1)^{k-j}\times i^{\overline{j}}$</li><li><a href="https://www.cnblogs.com/black-swallow/p/16068322.html#5112039">组合数公式全家桶</a></li></ul><p>容易发现 $\binom{n}{m}$ 是一个定值，所以只需要化简分子。</p><p>$$<br>\begin{split}<br>S&amp;&#x3D;\sum\limits_{i&#x3D;m}^n\binom{i-1}{m-1}\times i^k\<br>&amp;&#x3D;\sum\limits_{i&#x3D;m}^n\binom{i-1}{m-1}\times \sum\limits_{j&#x3D;0}^k\begin{Bmatrix}k\j\end{Bmatrix}(-1)^{k-j}\times i^{\overline{j}}\<br>&amp;&#x3D;\sum_{j&#x3D;0}^k\begin{Bmatrix}k\j\end{Bmatrix}(-1)^{k-j}\sum_{i&#x3D;m}^n\binom{i-1}{m-1}\times i^{\overline{j}}\<br>&amp;&#x3D;\sum_{j&#x3D;0}^k\begin{Bmatrix}k\j\end{Bmatrix}(-1)^{k-j}\sum_{i&#x3D;m}^n<br>\frac{(i-1)!}{(m-1)!(i-m)!}\times\frac{(i + j - 1)!}{(i-1)!}\<br>&amp;&#x3D;\sum_{j&#x3D;0}^k\begin{Bmatrix}k\j\end{Bmatrix}(-1)^{k-j}\sum_{i&#x3D;m}^n<br>\frac{(i + j - 1)!}{(m-1)!(i-m)!}\<br>\end{split}<br>$$<br>我们设 $t&#x3D; i - m$ ，并用 $t$ 代替式子中的 $i$ 。<br>$$<br>\begin{split}<br>S &amp;&#x3D; \sum_{j&#x3D;0}^k\begin{Bmatrix}k\j\end{Bmatrix}(-1)^{k-j}\sum_{i&#x3D;m}^n<br>\frac{(i + j - 1)!}{(m-1)!(i-m)!}\<br>&amp;&#x3D;\sum_{j&#x3D;0}^k\begin{Bmatrix}k\j\end{Bmatrix}(-1)^{k-j}\sum_{i&#x3D;0}^{n - m}<br>\frac{(t + m + j - 1)!}{(m-1)!\times t!}\<br>&amp;&#x3D;\frac{1}{(m-1)!}\sum_{j&#x3D;0}^k\begin{Bmatrix}k\j\end{Bmatrix}(-1)^{k-j}\sum_{i&#x3D;0}^{n - m}<br>\frac{(t + m + j - 1)!}{t!}\<br>&amp;&#x3D;\frac{1}{(m-1)!}\sum_{j&#x3D;0}^k\begin{Bmatrix}k\j\end{Bmatrix}(-1)^{k-j}\sum_{i&#x3D;0}^{n - m}<br>\frac{(t + m + j - 1)!}{t!\times (m+j-1)!}\times(m+j-1)!\<br>&amp;&#x3D; \frac{1}{(m-1)!}\sum_{j&#x3D;0}^k\begin{Bmatrix}k\j\end{Bmatrix}(-1)^{k-j}(m+j-1)!\sum_{i&#x3D;0}^{n - m}<br>\frac{(t + m + j - 1)!}{t!\times (m+j-1)!}\<br>&amp;&#x3D;\frac{1}{(m-1)!}\sum_{j&#x3D;0}^k\begin{Bmatrix}k\j\end{Bmatrix}(-1)^{k-j}(m+j-1)!\sum_{i&#x3D;0}^{n - m}\binom{t+m+j-1}{m+j-1}\<br>&amp;&#x3D;\frac{1}{(m-1)!}\sum_{j&#x3D;0}^k\begin{Bmatrix}k\j\end{Bmatrix}(-1)^{k-j}(m+j-1)!\binom{m+j-1+n-m+1}{n-m}\<br>&amp;&#x3D;\frac{1}{(m-1)!}\sum_{j&#x3D;0}^k\begin{Bmatrix}k\j\end{Bmatrix}(-1)^{k-j}(m+j-1)!\binom{n + j}{n-m}\<br>\end{split}<br>$$</p><p>发现只有一个和 $i$ 有关的组合数，其他的可以直接预处理。<br>每次操作的复杂度是 $O(k)$ ，$T$ 组数据的话就是 $O(Tk)$ 。</p><p>代码小学难度。</p>]]></content>
    
    
    
    <tags>
      
      <tag>题解</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
