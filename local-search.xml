<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>基础组合数练习题</title>
    <link href="/2022/11/06/ji_chu_zu_he_lian_xi_ti/"/>
    <url>/2022/11/06/ji_chu_zu_he_lian_xi_ti/</url>
    
    <content type="html"><![CDATA[<p>题目很简单，求： <span class="math display">\[Ans=\frac{ \sum\limits_{ i=m }^n\binom{i-1} {m-1}\times i^k} {\binom{n}{m} }\]</span> 其中，给定 <span class="math inline">\(n\)</span> ，<spanclass="math inline">\(m\)</span> 和 <spanclass="math inline">\(k\)</span> 。<br />满足 <span class="math inline">\(m\leq n \leq 10^7 , k\leq 5000\)</span>，数据组数不超过 <span class="math inline">\(5000\)</span> 。</p><p>前置知识：<br /></p><ul><li><p><spanclass="math inline">\(i^k=\sum\limits_{j=0}^k\begin{Bmatrix}k\\j\end{Bmatrix}(-1)^{k-j}\timesi^{\overline{j} }\)</span></p></li><li><p><ahref="https://www.cnblogs.com/black-swallow/p/16068322.html#5112039">组合数公式全家桶</a></p></li></ul><p>容易发现 <span class="math inline">\(\binom{n} {m}\)</span>是一个定值，所以只需要化简分子。</p><p><span class="math display">\[\begin{split}S&amp;=\sum\limits_{i=m}^n\binom{i-1} {m-1}\times i^k\\&amp;=\sum\limits_{i=m}^n\binom{i-1} {m-1}\times\sum\limits_{j=0}^k\begin{Bmatrix}k\\j\end{Bmatrix}(-1)^{k-j}\timesi^{\overline{j} }\\&amp;=\sum_{j=0}^k\begin{Bmatrix}k\\j\end{Bmatrix}(-1)^{k-j}\sum_{i=m}^n\binom{i-1}{m-1}\times i^{\overline{j} }\\&amp;=\sum_{j=0}^k\begin{Bmatrix}k\\j\end{Bmatrix}(-1)^{k-j}\sum_{i=m}^n\frac{(i-1)!} {(m-1)!(i-m)!}\times\frac{(i + j - 1)!} {(i-1)!}\\&amp;=\sum_{j=0}^k\begin{Bmatrix}k\\j\end{Bmatrix}(-1)^{k-j}\sum_{i=m}^n\frac{(i + j - 1)!} {(m-1)!(i-m)!}\\\end{split}\]</span> 我们设 <span class="math inline">\(t= i - m\)</span> ，并用<span class="math inline">\(t\)</span> 代替式子中的 <spanclass="math inline">\(i\)</span> 。 <span class="math display">\[\begin{split}S &amp;=\sum_{j=0}^k\begin{Bmatrix}k\\j\end{Bmatrix}(-1)^{k-j}\sum_{i=m}^n\frac{(i + j - 1)!} {(m-1)!(i-m)!}\\&amp;=\sum_{j=0}^k\begin{Bmatrix}k\\j\end{Bmatrix}(-1)^{k-j}\sum_{i=0}^{n- m}\frac{(t + m + j - 1)!} {(m-1)!\times t!}\\&amp;=\frac{1}{(m-1)!}\sum_{j=0}^k\begin{Bmatrix}k\\j\end{Bmatrix}(-1)^{k-j}\sum_{i=0}^{n- m}\frac{(t + m + j - 1)!} {t!}\\&amp;=\frac{1}{(m-1)!}\sum_{j=0}^k\begin{Bmatrix}k\\j\end{Bmatrix}(-1)^{k-j}\sum_{i=0}^{n- m}\frac{(t + m + j - 1)!} {t!\times (m+j-1)!}\times(m+j-1)!\\&amp;= \frac{1}{(m-1)!}\sum_{j=0}^k\begin{Bmatrix}k\\j\end{Bmatrix}(-1)^{k-j}(m+j-1)!\sum_{i=0}^{n- m}\frac{(t + m + j - 1)!} {t!\times (m+j-1)!}\\&amp;=\frac{1}{(m-1)!}\sum_{j=0}^k\begin{Bmatrix}k\\j\end{Bmatrix}(-1)^{k-j}(m+j-1)!\sum_{i=0}^{n- m}\binom{t+m+j-1} {m+j-1}\\&amp;=\frac{1}{(m-1)!}\sum_{j=0}^k\begin{Bmatrix}k\\j\end{Bmatrix}(-1)^{k-j}(m+j-1)!\binom{m+j-1+n-m+1}{n-m}\\&amp;=\frac{1}{(m-1)!}\sum_{j=0}^k\begin{Bmatrix}k\\j\end{Bmatrix}(-1)^{k-j}(m+j-1)!\binom{n+ j} {n-m}\\\end{split}\]</span></p><p>发现只有一个和 <span class="math inline">\(i\)</span>有关的组合数，其他的可以直接预处理。<br />每次操作的复杂度是 <span class="math inline">\(O(k)\)</span> ，<spanclass="math inline">\(T\)</span> 组数据的话就是 <spanclass="math inline">\(O(Tk)\)</span> 。</p><p>代码小学难度。</p>]]></content>
    
    
    
    <tags>
      
      <tag>题解</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
